const path = __dirname.replace('/node_modules/pratos_weather_plugin', '');
var fs = require('fs');
var Cookies = require("cookies");
var User = require("pratos_user_class"); 
var lastUpdateTime = 0;
var apiKey = null;
module.exports = {
	config:function(){
fs.readFile("apiKey", 'utf8', function(err, data){
  apiKey = data;
});
		var conf = Object();
		conf.GET = true;
		conf.on_homepage = true;
conf.on_content = true;
conf.has_settings = true;
		return conf;
	},
content:function(link){
		link.push("<script src='/weather.js'></script>");
		return link;
	},
homepage:function(homepage){
		homepage.createBox("Weather", "<p style='padding: 3%; text-align: center;'>Fetching weather... <br /> Please wait ...</p>", true);
},
get:function(app, globalVariable){
		app.get('/weather.js', function(req, res) {
			res.setHeader('Content-Type', 'application/javascript');
			fs.readFile( __dirname + '/weather.js', 'utf8', function(err, data){
			res.end(data);
});
		});
		app.get('/weatherApiKey', function(req, res) {
			res.setHeader('Content-Type', 'text/html');
			if(!apiKey){
			res.end("0");
}
else{
			res.end("1");
}
		});
},
has_settings:function(globalvariable){
var y = {title: "Weather", buttonName:"weatherButton", buttonIcon:"<i class='fa fa-cloud'></i>",boxContent:"<h2>Weather</h2>"};
return y;
}
};