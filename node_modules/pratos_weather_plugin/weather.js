var urlSplitted = window.location.href.split('/');
var file = urlSplitted[(urlSplitted.length - 1)] || urlSplitted[(urlSplitted.length - 2)];
if(file == "index"){
}
else if(file == "settings"){
var global_color=$("h1").css("color");
$('#weatherButton').click(function(){
$.get('/weatherApiKey',function(data){

if(!isJson(data)|| !(JSON.parse(data)).keyCode){

$('#weatherBox').html("<h3 style='text-align:center'>Cl\351 d'API manquante</h3><p>Pour en obtenir une, inscrivez-vous sur le site <a href='https://home.openweathermap.org/users/sign_up'>OpenWeatherMap</a>.<br />Apr\350s l\u2019inscription allez dans <i>--API Keys--</i> puis copiez et collez la cl\351 par d\351faut ici :</p><input id='weatherApiKeyField' style='display:block;width:70%;margin:2% auto;' type='text'> <input id='weatherApiKeySubmit' style='color:"+ global_color +"; border-color:"+global_color+"; display:block;margin:2% auto;' type='submit'>");
$("#weatherApiKeySubmit").click(function(){
var apiKey = $("#weatherApiKeyField").val();
$.get('/weatherApiSendKey?apikey='+ apiKey,function(data){
if(isJson(data) && (JSON.parse(data)).keyCode){
data = JSON.parse(data);
var otherLocationChecked = (data.location && data.location != 1)? "checked":"";

var myLocation = (!data.location || data.location == 1)? "checked":"";
var myLocationInputStyle = (!data.location || data.location == 1)? "none":"block";
var myLocationInputValue = (data.location && data.location != 1)? data.location:"";
$('#weatherBox'). html("<h3 style='text-align:center'>Open Weather Api</h3><h3>Localisation :</h3><label for='localisationHomePageMine'>Ma position :</label><input id='localisationHomePageMine' name='localisationHomePage' type='radio' "+ myLocation +"/><br /> <label for='localisationHomePageOther'>Autre position :</label><input id='localisationHomePageOther' name='localisationHomePage' type='radio'/><div style='display:"+ myLocationInputStyle +"' id='hidenBlockPersonalLocation' "+ otherLocationChecked +"><label for='personalLocationInput'>Autre :</label><input type='text'value='"+ myLocationInputValue +"' id='personalLocationInput'placeholder='Ville'/> </div><input id='weatherApiKeySubmit' style='color:"+ global_color +"; border-color:"+global_color+"; display:block;margin:2% auto;' value='Changer'  type='submit'><button id='disconnectWeather'style='color:red; border-color:red; font-size:100%; font-weight:300;display:block;margin:2% auto;'>Se d\351connecter</button>");
$("#disconnectWeather").click(function(){

$.get('/weatherApiDisconnect',function(data){
$('#weatherButton').trigger('click');
});
});
$('#personalLocationInput').focus(function(){
$("#localisationHomePageOther").click();
$('#personalLocationInput').focusIn();
});
$("#weatherApiKeySubmit").click(function(){
if($("#localisationHomePageOther").is(':checked')){
var cityName = $("#personalLocationInput").val();
}
else{
var cityName = 1;
}

$.get('/weatherApiSetInfos?location='+cityName,function(data){
alert("Update done");
});
});
$("#localisationHomePageOther").change(function(){
if($("#localisationHomePageOther").is(':checked') == 1){
$("#hidenBlockPersonalLocation").show(500);



}

});
$("#localisationHomePageMine").change(function(){
if($("#localisationHomePageMine").is(':checked') == 1){
$("#hidenBlockPersonalLocation").hide(500);



}

});
}
else{
alert(data);
}
});
});
}
else{
data = JSON.parse(data);
var otherLocationChecked = (data.location && data.location != 1)? "checked":"";

var myLocation = (!data.location || data.location == 1)? "checked":"";
var myLocationInputStyle = (!data.location || data.location == 1)? "none":"block";
var myLocationInputValue = (data.location && data.location != 1)? data.location:"";
$('#weatherBox').html("<h3 style='text-align:center'>Open Weather Api</h3><h3>Localisation :</h3><label for='localisationHomePageMine'>Ma position :</label><input id='localisationHomePageMine' name='localisationHomePage' type='radio' "+ myLocation +"/><br /> <label for='localisationHomePageOther'>Autre position :</label><input id='localisationHomePageOther' name='localisationHomePage' type='radio'/><div style='display:"+ myLocationInputStyle +"' id='hidenBlockPersonalLocation' "+ otherLocationChecked +"><label for='personalLocationInput'>Autre :</label><input type='text'value='"+ myLocationInputValue +"' id='personalLocationInput'placeholder='Ville'/> </div><input id='weatherApiKeySubmit' style='color:"+ global_color +"; border-color:"+global_color+"; display:block;margin:2% auto;' value='Changer'  type='submit'><button id='disconnectWeather'style='color:red; border-color:red; font-size:100%; font-weight:300;display:block;margin:2% auto;'>Se d\351connecter</button>");
$('#personalLocationInput').focus(function(){
$("#localisationHomePageOther").click();
$('#personalLocationInput').focusIn();
});
$("#disconnectWeather").click(function(){

$.get('/weatherApiDisconnect',function(data){
$('#weatherButton').trigger('click');
});
});
$("#weatherApiKeySubmit").click(function(){
if($("#localisationHomePageOther").is(':checked')){
var cityName = $("#personalLocationInput").val();
}
else{
var cityName = 1;
}

$.get('/weatherApiSetInfos?location='+cityName,function(data){
alert("Update done");
});
});
$("#localisationHomePageOther").change(function(){
if($("#localisationHomePageOther").is(':checked') == 1){
$("#hidenBlockPersonalLocation").show(500);



}

});
$("#localisationHomePageMine").change(function(){
if($("#localisationHomePageMine").is(':checked') == 1){
$("#hidenBlockPersonalLocation").hide(500);



}

});
}
});
});

$('#weatherBox').html("<h2>Weather</h2>");

}
function isJson(str) {
    try {
        JSON.parse(str);
    } catch (e) {
        return false;
    }
    return true;
}


			
//92b9a712cca60d3789405803387b0702
